macro(ADD_UT CATEGORY NAME SOURCES LIBRARIES)
  set_source_files_properties(${SOURCES} PROPERTIES GENERATED TRUE)
  add_executable(${NAME} ${CATEGORY}/${NAME}.c ${CATEGORY}.c ${SOURCES})
  if(${LIBRARIES})
    target_link_librairies(${NAME} ${LIBRARIES})
  endif()
  string(TOUPPER ${CATEGORY} UT_DEFINE)
  string(CONCAT UT_DEFINE "UT_" ${UT_DEFINE})
  target_compile_definitions(${NAME} PRIVATE ${UT_DEFINE})
  add_test(NAME ${CATEGORY}_${NAME} COMMAND ${NAME})
  install(TARGETS ${NAME} RUNTIME DESTINATION ${PROJECT_BINARY_DIR}/bin/ut/${CATEGORY})
endmacro()

add_ut(lexer label ${FLEX_LEXER_OUTPUTS} ${FLEX_LIBRARIES})